## ‚úÖ Method: Send Email via Microsoft 365 (Exchange Online SMTP)

### üîí Prerequisites

1. ‚úÖ You need a **licensed M365 mailbox account** (e.g., `it@xitiztechservices.com`)
2. ‚úÖ That account must allow SMTP AUTH (enabled by default but can be restricted by policy)
3. ‚úÖ You must use an **App Password** if MFA is enabled

---

## üîß Step-by-Step Setup

---

### ‚úÖ Step 1: Enable SMTP AUTH for the sending account (if needed)

Run this from PowerShell (Exchange Online module):

```powershell
Set-CASMailbox -Identity "it@xitiztechservices.com" -SmtpClientAuthenticationDisabled $false
```

---

### ‚úÖ Step 2: Generate an App Password

If the sending account has MFA:

1. Go to [https://mysignins.microsoft.com/security-info](https://mysignins.microsoft.com/security-info)
2. Add **"App Password"**
3. Use this password in your script (not your normal password)

---

### ‚úÖ Step 3: Use PowerShell to Send Email via M365 SMTP

```powershell
# Define sender credentials
$Username = "it@xitiztechservices.com"
$AppPassword = "your-app-password-here"  # From M365 app password generator
$SecurePassword = ConvertTo-SecureString $AppPassword -AsPlainText -Force
$Credential = New-Object System.Management.Automation.PSCredential($Username, $SecurePassword)

# Send welcome email
Send-MailMessage -From $Username `
                 -To "$sam@xitiztechservices.com" `
                 -Subject "Welcome to XitizTech Services!" `
                 -Body "Hi $name,

Your Active Directory account has been created.

Username: $sam
Temporary Password: P@ssw0rd123!
Domain: xitiztechservices.local

Please change your password at first login.

Regards,
IT Department" `
                 -SmtpServer "smtp.office365.com" `
                 -Port 587 `
                 -UseSsl `
                 -Credential $Credential
```

> üîê The above example works with any **M365 licensed mailbox** that can send mail.

---

## ‚úÖ Optional: Use HTML for a Branded Welcome Message

```powershell
$Body = @"
<html>
<body>
<h2>Welcome to XitizTech Services!</h2>
<p>Hi $name,</p>
<p>Your AD account has been created:</p>
<ul>
<li><b>Username:</b> $sam</li>
<li><b>Temporary Password:</b> P@ssw0rd123!</li>
<li><b>Domain:</b> xitiztechservices.local</li>
</ul>
<p>Please change your password on first login.</p>
<p>Regards,<br>IT Department</p>
</body>
</html>
"@

Send-MailMessage -From $Username `
                 -To "$sam@xitiztechservices.com" `
                 -Subject "Welcome to XitizTech Services!" `
                 -Body $Body `
                 -BodyAsHtml `
                 -SmtpServer "smtp.office365.com" `
                 -Port 587 `
                 -UseSsl `
                 -Credential $Credential
```

---

## üìå Final Notes

| Item        | Detail                                                                           |
| ----------- | -------------------------------------------------------------------------------- |
| SMTP Server | `smtp.office365.com`                                                             |
| Port        | 587                                                                              |
| Encryption  | SSL/TLS                                                                          |
| Auth        | Username + App Password or Basic Auth (if allowed)                               |
| Alternative | Use **Graph API** or **Send-Mail API** for enterprise-grade automation (no SMTP) |

---
