## üîÅ What Is User Provisioning in AD?

> Provisioning = Automatically creating user accounts, placing them in correct OUs, assigning to groups, setting passwords, applying policies, etc.

---

## ‚úÖ Common Methods to Automate AD User Provisioning

| Method                                      | Description                                                | Best For                |
| ------------------------------------------- | ---------------------------------------------------------- | ----------------------- |
| üß© **PowerShell Scripts**                   | Custom scripts to create users, assign groups, move to OUs | Most common, flexible   |
| üßæ **CSV + PowerShell**                     | Import users from a spreadsheet                            | HR-driven onboarding    |
| üì¶ **Identity Manager (MIM/Azure AD/Okta)** | Full identity lifecycle automation                         | Enterprises             |
| üß© **Third-Party Tools**                    | ADManager Plus, Specops, ManageEngine                      | GUI-friendly automation |

---

## üîß Let‚Äôs Do It with PowerShell + CSV (Most Practical)

This method allows:

* **IT** to onboard users in bulk
* **HR** to send a list (CSV) and IT runs it

---

### ‚úÖ Step 1: Prepare the CSV File

Save as `new_users.csv`

```csv
FirstName,LastName,Username,Department,Title,OU,Group
John,Doe,jdoe,IT,Network Engineer,OU=IT,IT_Staff
Jane,Smith,jsmith,HR,HR Assistant,OU=HR,HR_Staff
```

---

### ‚úÖ Step 2: PowerShell Script (Auto-Provisioning)

```powershell
# File: Create-ADUsers.ps1
Import-Module ActiveDirectory

$users = Import-Csv "C:\Scripts\new_users.csv"

foreach ($user in $users) {
    $name = "$($user.FirstName) $($user.LastName)"
    $sam = $user.Username
    $password = ConvertTo-SecureString "P@ssw0rd123!" -AsPlainText -Force
    $ou = "OU=$($user.OU),DC=xitiztechservices,DC=local"

    # Create the user
    New-ADUser -Name $name `
               -GivenName $user.FirstName `
               -Surname $user.LastName `
               -SamAccountName $sam `
               -UserPrincipalName "$sam@xitiztechservices.local" `
               -AccountPassword $password `
               -DisplayName $name `
               -Path $ou `
               -Department $user.Department `
               -Title $user.Title `
               -Enabled $true `
               -ChangePasswordAtLogon $true

    # Add to Group
    Add-ADGroupMember -Identity $user.Group -Members $sam

    Write-Host "Created: $name in $ou and added to $($user.Group)"
}
```

---

### ‚úÖ Step 3: Run the Script

1. Save the script as `Create-ADUsers.ps1`
2. Open PowerShell as Admin
3. Run:

```powershell
.\Create-ADUsers.ps1
```

---

### ‚úÖ Output

‚úî Users created in correct **OUs**
‚úî Passwords set (with first login change)
‚úî Auto-added to **security groups**

---

## üîê Optional Add-Ons for Advanced Provisioning

| Task                      | Method                                            |
| ------------------------- | ------------------------------------------------- |
| Send welcome email        | Add PowerShell `Send-MailMessage`                 |
| Create mailbox (Exchange) | Add `Enable-Mailbox` if using Exchange            |
| Add to shared drives      | Add to mapped drive groups via GPO                |
| Create home folders       | Use `New-Item` and set permissions via PowerShell |
| Track changes             | Log script output to a `.txt` or event log        |

---

## üõë Security Tips

* Don‚Äôt hardcode passwords in production. Use **secure prompts** or secrets vault.
* Always log which users were created and by whom.
* Periodically audit which scripts were run.

---
