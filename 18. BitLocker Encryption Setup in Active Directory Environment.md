# BitLocker Encryption Setup in Active Directory Environment

## ðŸ” What is BitLocker?

* Built-in disk encryption on Windows (Pro/Enterprise)
* Protects data if a device is lost or stolen
* Can be centrally managed and recovery keys stored in AD

---

## ðŸ›  Step 1: Prepare Active Directory for BitLocker

By default, AD doesnâ€™t store BitLocker recovery keys unless configured.

### Configure AD Schema to store BitLocker recovery info:

* On a Domain Controller, run:

```powershell
# Import AD module
Import-Module ActiveDirectory

# Enable BitLocker recovery password storage in AD
Enable-BitLockerADBackup -Domain "xitiztechservices.local"
```

*Note*: This cmdlet is available on newer RSAT/Windows Server versions. If unavailable, manually enable the relevant Group Policy.

---

## ðŸ›  Step 2: Configure Group Policy for BitLocker

Open `gpedit.msc` or use Group Policy Management Console (`gpmc.msc`) and edit or create a GPO linked to your target computers OU.

---

### Configure policies under:

```
Computer Configuration
 â†’ Policies
 â†’ Administrative Templates
 â†’ Windows Components
 â†’ BitLocker Drive Encryption
```

---

### Important policies to set:

| Policy                                                                       | Recommendation                                     |
| ---------------------------------------------------------------------------- | -------------------------------------------------- |
| **Require additional authentication at startup**                             | Enabled, allow TPM or TPM+PIN                      |
| **Store BitLocker recovery information in Active Directory Domain Services** | Enabled (Backup recovery password and key package) |
| **Configure use of passwords for operating system drives**                   | Enabled (Set password complexity as needed)        |
| **Enable BitLocker on operating system drives**                              | Enabled                                            |
| **Enable BitLocker on fixed data drives**                                    | Enabled (optional for data drives)                 |

---

## ðŸ›  Step 3: Enable BitLocker on Client Machines

* Open **Control Panel** â†’ **BitLocker Drive Encryption**
* Click **Turn on BitLocker** on the system drive (usually C:)
* Follow prompts to:

  * Use TPM + PIN or password
  * Save recovery key to Active Directory (automatic if GPO configured)
  * Encrypt entire drive or used space only (choose based on environment)

Alternatively, use PowerShell to enable BitLocker:

```powershell
Enable-BitLocker -MountPoint "C:" -UsedSpaceOnly -RecoveryPasswordProtector
```

---

## ðŸ›¡ Step 4: Manage Recovery Keys in Active Directory

* Recovery keys are stored under the computer object in AD:

  * Open **Active Directory Users and Computers (ADUC)**
  * Enable **Advanced Features** (`View` > `Advanced Features`)
  * Navigate to the computer object > right-click > **Properties**
  * Go to **Attribute Editor** tab
  * Look for `msFVE-RecoveryInformation`

* You can use tools or PowerShell to retrieve keys if users forget passwords.

---

## ðŸ§¾ Step 5: Audit and Monitor BitLocker Status

* Use Event Viewer:

  * Path:

    ```
    Applications and Services Logs â†’ Microsoft â†’ Windows â†’ BitLocker-API
    ```
* Use PowerShell to check status:

```powershell
Get-BitLockerVolume | Format-List MountPoint, VolumeStatus, ProtectionStatus, KeyProtector
```

---

## ðŸ’¡ Tips & Best Practices

| Best Practice                                  | Reason                                      |
| ---------------------------------------------- | ------------------------------------------- |
| Enable BitLocker during imaging or first login | Ensures compliance from the start           |
| Backup recovery keys automatically to AD       | Prevents data loss if user forgets password |
| Use TPM with PIN for better security           | Adds multi-factor protection                |
| Train users on recovery key safekeeping        | Reduces support calls                       |
| Monitor encryption status regularly            | Avoid non-compliant devices                 |

---

## ðŸš€ Bonus: Enable BitLocker via Intune (M365 Managed Devices)

If your company uses **Microsoft Endpoint Manager (Intune)** with M365, you can deploy BitLocker policies and monitor compliance centrally.

---
