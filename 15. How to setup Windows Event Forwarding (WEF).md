## ğŸ¯ Why Use Windows Event Forwarding?

| Benefit                | Description                                                 |
| ---------------------- | ----------------------------------------------------------- |
| ğŸ“Š Centralized Logging | Aggregate logs from all workstations/servers into one place |
| ğŸ›¡ Security Monitoring | Monitor failed logins, privilege escalation, etc.           |
| ğŸ“‹ Compliance          | Helps meet auditing & log retention requirements            |
| ğŸ’° Cost-Efficient      | No third-party license required â€” itâ€™s built into Windows   |

---

## ğŸ› ï¸ Step-by-Step Setup of Windows Event Forwarding (Domain Environment)

---

### âœ… Components Overview

| Role              | Server/Device                                    | Purpose                |
| ----------------- | ------------------------------------------------ | ---------------------- |
| **Collector**     | A central Windows Server (e.g., DC, file server) | Receives logs          |
| **Source/Client** | Domain PCs/servers                               | Send logs to collector |

---

## âœ… Step 1: Configure the Event Collector Server

1. **Log in to your collector server** (e.g., `Server01`)
2. Open PowerShell (Admin) and run:

```powershell
wecutil qc
```

> This sets up the **Windows Event Collector** service and enables it.

3. Go to **Services** and ensure:

   * `Windows Event Collector` = Running, Automatic

---

## âœ… Step 2: Create a Subscription (Collector Side)

1. Open **Event Viewer**

2. In the left pane, click:

   ```
   Subscriptions > Create Subscription
   ```

3. Fill out:

   * **Name**: Workstation Logon Events
   * **Destination Log**: Forwarded Events (default)
   * **Collector initiated** (recommended for domain use)

4. Click **Select Events**:

   * For example: Security log â†’ Event ID 4624, 4625, 4672
   * You can use XML filters too (optional)

5. Click **Select Computers** > Add domain computers (or an AD group)

---

## âœ… Step 3: Configure GPO on Client Systems

To allow clients to forward logs to the collector:

1. Open **Group Policy Management Console (`gpmc.msc`)**
2. Create a new GPO: `WEF Client Policy`
3. Edit it:

---

### ğŸ”¹ Enable WinRM (Remote Event Access)

```
Computer Configuration
â†’ Policies
â†’ Administrative Templates
â†’ Windows Components
â†’ Windows Remote Management (WinRM)
â†’ WinRM Service
â†’ Allow remote server management through WinRM
```

* Set to **Enabled**
* Add: `*` or FQDN of collector

---

### ğŸ”¹ Set up Windows Event Forwarding

```
Computer Configuration
â†’ Policies
â†’ Administrative Templates
â†’ Windows Components
â†’ Event Forwarding
â†’ Configure target Subscription Manager
```

* Set to **Enabled**
* Value (example):

  ```
  Server=HTTP://server01.xitiztechservices.local:5985/wsman/SubscriptionManager/WEC,Refresh=60
  ```

> Adjust FQDN accordingly.

---

## âœ… Step 4: Link GPO and Update Clients

* Link the GPO to your **domain computers** OU
* On clients, run:

```bash
gpupdate /force
```

* Confirm WinRM is listening:

```powershell
winrm quickconfig
```

---

## âœ… Step 5: Verify Log Forwarding

On the **collector server**:

* Open **Event Viewer**
* Go to:

  ```
  Applications and Services Logs > Microsoft > Windows > EventCollector
  ```
* Youâ€™ll also see logs appear under:

  ```
  Forwarded Events
  ```

---

## ğŸ§  Optional Enhancements

| Feature             | Tool                                             |
| ------------------- | ------------------------------------------------ |
| ğŸ“Š SIEM Integration | Forward to Splunk, Sentinel, or Graylog          |
| ğŸ“¥ Email Alerts     | Use Task Scheduler or script on critical events  |
| ğŸ“ Save to File     | Auto-export logs for archiving/compliance        |
| ğŸ” Filters          | Use XML to filter by user, computer, event type  |
| ğŸ“¦ WEC + Power BI   | Visualize security events for management reports |

---

## ğŸ“‹ Sample Use Case: Track Failed Logons

Monitor `Event ID 4625` from all domain machines:

* Create a subscription for Security logs with that ID
* Forward them to `Server01`
* Filter by `SubjectUserName` or `WorkstationName`

---

## âœ… Summary: What You Need

| Task                          | Required |
| ----------------------------- | -------- |
| Collector with WEC service    | âœ…        |
| Domain-joined client machines | âœ…        |
| WinRM enabled via GPO         | âœ…        |
| Proper GPO scope              | âœ…        |
| Subscriptions configured      | âœ…        |

---
