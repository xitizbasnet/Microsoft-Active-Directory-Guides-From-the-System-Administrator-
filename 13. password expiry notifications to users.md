## ‚úÖ Why This Matters

Without notifications:

* Users get **locked out** unexpectedly
* More support tickets for password resets
* Frustration when logging into M365/Outlook/Teams

---

## ‚úÖ Method 1: **GPO-Based Balloon Notification (Default Windows)**

### üõ† Enabled by Default:

Windows will show a **notification at login** starting **14 days before password expiry**.

### üîç You can adjust this using Group Policy:

**GPO Path:**

```
Computer Configuration
‚Üí Windows Settings
‚Üí Security Settings
‚Üí Local Policies
‚Üí Security Options
‚Üí Interactive logon: Prompt user to change password before expiration
```

**Default:** 14 days
**Recommended:** 7‚Äì14 days

---

## ‚úÖ Method 2: PowerShell Script to Send Email (Custom Notification)

Create a scheduled task or run a **daily script** that checks for users whose passwords are about to expire and **sends email alerts**.

### üí° Example PowerShell Script

```powershell
# Parameters
$DaysBeforeExpiry = 7
$Domain = "xitiztechservices.local"
$SMTPServer = "smtp.office365.com"
$Sender = "it@xitiztechservices.com"

# Credentials (use App Password if MFA is enabled)
$Password = ConvertTo-SecureString "your-app-password" -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential($Sender, $Password)

# Get users whose passwords expire within X days
$users = Get-ADUser -Filter * -Properties "DisplayName", "EmailAddress", "PasswordLastSet", "PasswordNeverExpires", "msDS-UserPasswordExpiryTimeComputed" |
Where-Object {
    $_.Enabled -eq $true -and
    $_.PasswordNeverExpires -eq $false -and
    $_."msDS-UserPasswordExpiryTimeComputed"
} | ForEach-Object {
    $expiryDate = [datetime]::FromFileTime($_."msDS-UserPasswordExpiryTimeComputed")
    $daysLeft = ($expiryDate - (Get-Date)).Days
    if ($daysLeft -le $DaysBeforeExpiry -and $daysLeft -gt 0) {
        $_ | Add-Member -MemberType NoteProperty -Name DaysLeft -Value $daysLeft -PassThru
    }
}

# Send Emails
foreach ($user in $users) {
    $body = @"
Hi $($user.DisplayName),

Your Active Directory password will expire in $($user.DaysLeft) day(s).

Please change it soon to avoid being locked out of your account.

If you need help, contact IT Support.

Thanks,  
XitizTech IT Department
"@

    Send-MailMessage -From $Sender `
                     -To $user.EmailAddress `
                     -Subject "Password Expiry Notification ($($user.DaysLeft) days left)" `
                     -Body $body `
                     -SmtpServer $SMTPServer `
                     -Port 587 `
                     -UseSsl `
                     -Credential $Cred

    Write-Host "Notified: $($user.SamAccountName) ($($user.DaysLeft) days left)"
}
```

---

### üïê Schedule This Daily

Use **Task Scheduler** on a server to run the script every morning:

* Trigger: Daily at 7:00 AM
* Action: Run PowerShell with script path

---

## ‚úÖ Method 3: Microsoft 365 Notification (Cloud-only users)

If you're in a **hybrid or cloud-only environment**:

* M365 users get prompted via **browser or Teams/Outlook**
* You can use **Microsoft Entra ID Identity Protection** or **conditional access** to enforce password changes
* Advanced notifications can be scripted using **Microsoft Graph API**

---

## üîê Security Note

Never expose plain-text passwords in scripts.

* Store credentials securely using **`Get-Credential`** or **Credential Manager**
* Or move to **Graph API / Azure Functions** for token-based notifications

---

## ‚úÖ Summary Table

| Method                  | Scope            | Email Support | Customizable              |
| ----------------------- | ---------------- | ------------- | ------------------------- |
| GPO Warning             | Local only       | ‚ùå             | ‚ö† Minimal                 |
| PowerShell Email Script | All domain users | ‚úÖ             | ‚úÖ Full                    |
| M365/Graph API          | Cloud users      | ‚úÖ             | ‚úÖ (advanced dev required) |

---
